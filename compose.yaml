services:
  user:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        NEXT_PUBLIC_API_ROUTE: ${NEXT_PUBLIC_API_ROUTE}
        NEXT_PUBLIC_TOKEN_NAME: ${NEXT_PUBLIC_TOKEN_NAME}
        APP_VERSION: ${APP_VERSION:-1.0.0}
    container_name: ${USER_CONTAINER_NAME:-homecyclhome_user}
    env_file:
      - .env
    environment:
      NODE_ENV: ${NODE_ENV:-production}
      NEXT_PUBLIC_API_ROUTE: ${NEXT_PUBLIC_API_ROUTE}
      NEXT_PUBLIC_UPLOAD_DIR: ${NEXT_PUBLIC_UPLOAD_DIR}
      NEXT_PUBLIC_TOKEN_NAME: ${NEXT_PUBLIC_TOKEN_NAME}
      LOG_LEVEL: ${LOG_LEVEL:-info}
      NEXT_TELEMETRY_DISABLED: ${NEXT_TELEMETRY_DISABLED:-1}
    ports:
      # port isol√© (3000 prod / 3100 test)
      - "127.0.0.1:${USER_PORT:-3000}:3000"
    restart: unless-stopped
